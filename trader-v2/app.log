2025-04-30 07:11:51,449 - root - INFO - 测试日志输出到文件
2025-04-30 07:11:51,450 - __main__ - DEBUG - Starting the trading framework in BACKTEST mode...
2025-04-30 07:11:51,456 - core.event_bus - INFO - Created subscription list for event type: SignalEvent
2025-04-30 07:11:51,456 - core.event_bus - INFO - Subscribed handler _on_signal_event to event type: SignalEvent
2025-04-30 07:11:51,456 - core.event_bus - INFO - Created subscription list for event type: FillEvent
2025-04-30 07:11:51,456 - core.event_bus - INFO - Subscribed handler _on_fill_event to event type: FillEvent
2025-04-30 07:11:51,456 - core.event_bus - INFO - Created subscription list for event type: MarketEvent
2025-04-30 07:11:51,456 - core.event_bus - INFO - Subscribed handler _on_market_event to event type: MarketEvent
2025-04-30 07:11:51,456 - components.portfolio - INFO - MomentumPortfolio initialized with $100000.00 cash.
2025-04-30 07:11:51,456 - components.portfolio - INFO - MomentumPortfolio initialized with lot_size=100.
2025-04-30 07:11:51,457 - core.event_bus - INFO - Subscribed handler _on_market_event to event type: MarketEvent
2025-04-30 07:11:51,457 - components.strategy - INFO - MomentumStrategy initialized.
2025-04-30 07:11:51,457 - components.strategy - INFO - MomentumStrategy initialized with period=60, weight=0.5.
2025-04-30 07:11:51,457 - core.event_bus - INFO - Created subscription list for event type: OrderEvent
2025-04-30 07:11:51,457 - core.event_bus - INFO - Subscribed handler _on_order_event to event type: OrderEvent
2025-04-30 07:11:51,457 - core.event_bus - INFO - Subscribed handler _on_market_event_for_settlement to event type: MarketEvent
2025-04-30 07:11:51,457 - components.execution_handler - INFO - SimulatedExecutionHandler initialized.
2025-04-30 07:11:51,457 - components.execution_handler - INFO - SimulatedExecutionHandler initialized with commission=0.0010, slippage=0.0005.
2025-04-30 07:11:51,457 - core.event_bus - INFO - Subscribed handler on_market_event to event type: MarketEvent
2025-04-30 07:11:51,457 - __main__ - INFO - Event Bus run task created.
2025-04-30 07:11:51,457 - core.event_bus - INFO - Event Bus started.
2025-04-30 07:11:51,457 - components.csv_data_feed - INFO - CSVDataFeed started. Reading from etf.csv
2025-04-30 07:11:51,459 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,459 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,461 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,462 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,463 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,464 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,465 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,465 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,466 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,467 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,468 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,469 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,470 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,470 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,471 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,471 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,472 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,472 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,473 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,473 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,474 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,474 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,475 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,475 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,476 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,476 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,477 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,478 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,478 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,479 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,479 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,480 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,481 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,481 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,482 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,482 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,483 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,483 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,485 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,485 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,487 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,487 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,489 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,489 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,491 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,491 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,492 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,493 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,494 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,494 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,495 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,496 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,497 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,497 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,499 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,499 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,500 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,501 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,502 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,502 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,504 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,504 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,505 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,506 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,507 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,507 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,508 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,509 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,510 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,510 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,512 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,512 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,513 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,514 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,515 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,515 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,516 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,517 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,518 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,519 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,520 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,521 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,523 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,523 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,525 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,526 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,527 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,528 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,530 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,531 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,533 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,534 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,536 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,537 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,539 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,540 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,541 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,542 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,544 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,545 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,546 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,547 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,548 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,548 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,549 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,549 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,550 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,551 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,552 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,552 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,553 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,553 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,554 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,555 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,555 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,556 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,557 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,557 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,558 - components.csv_data_feed - WARNING - Not enough data for symbol 513500.0 to get 61 periods.
2025-04-30 07:11:51,558 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,559 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,560 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,562 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,563 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,564 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,565 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,566 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,567 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,568 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,570 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,571 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,572 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,574 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,575 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,576 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,578 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,579 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,580 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,581 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,583 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,584 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,585 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,587 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,588 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,589 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,590 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,592 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,593 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,594 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,596 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,597 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,598 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,599 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,600 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,601 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,602 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,604 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,605 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,606 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,607 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,609 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,610 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,611 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,612 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,614 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,615 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,616 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,617 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,619 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,620 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,621 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,622 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,624 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,625 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,626 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,627 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,629 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,630 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,631 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,633 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,634 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,635 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,636 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,637 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,638 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,639 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,640 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,641 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,642 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,643 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,644 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,645 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,646 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,647 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,648 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,649 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,650 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,651 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,652 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,653 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,654 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,655 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,656 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,658 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,659 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,660 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,662 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,663 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,664 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,665 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,666 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,667 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,668 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,669 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,670 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,671 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,672 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,674 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,675 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,676 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,677 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,678 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,679 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,680 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,681 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,683 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,685 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,687 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,689 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,692 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,694 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,697 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,699 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,702 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,705 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,707 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,709 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,711 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,713 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,715 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,716 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,718 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,721 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,723 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,725 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,726 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,727 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,728 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,729 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,730 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,731 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,733 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,735 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,738 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,741 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,742 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,744 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,745 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,746 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,747 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,749 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,750 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,752 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,754 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,757 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,759 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,761 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,762 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,764 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,766 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,767 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,769 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,770 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,771 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,773 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,774 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,775 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,776 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,778 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,779 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,780 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,781 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,783 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,784 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,785 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,786 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,788 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,789 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,790 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,792 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,793 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,795 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,796 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,797 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,798 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,800 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,801 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,802 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,803 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,804 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,805 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,806 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,807 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,808 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,809 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,810 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,811 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,812 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,813 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,814 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,815 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,816 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,817 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,818 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,820 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,822 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,823 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,825 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,827 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,828 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,829 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,831 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,832 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,834 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,835 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,836 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,839 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,843 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,845 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,847 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,848 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,849 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,850 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,852 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,853 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,854 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,856 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,857 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,858 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,859 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,860 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,861 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,862 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,863 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,864 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,866 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,867 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,868 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,869 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,870 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,871 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,872 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,873 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,874 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,875 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,876 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,877 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,878 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,879 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,880 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,881 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,883 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,884 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,885 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,886 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,887 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,888 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,889 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,890 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,891 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,892 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,893 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,894 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,895 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,896 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,897 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,898 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,899 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,901 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,902 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,904 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,905 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,907 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,909 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,910 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,912 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,914 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,915 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,917 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,918 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,920 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,921 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,923 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,924 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,926 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,927 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,929 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,931 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,932 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,934 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,935 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,937 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,938 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,940 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,941 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,943 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,945 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,946 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,948 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,949 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,950 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,951 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,952 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,953 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,954 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,955 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,956 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,957 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,958 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,959 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,961 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,962 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,963 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,964 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,965 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,966 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,967 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,968 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,969 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,970 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,971 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,972 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,973 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,974 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,975 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,976 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,977 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,978 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,979 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,980 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,981 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,982 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,983 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,984 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,985 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,986 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,987 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,988 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,989 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,990 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,991 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,992 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,993 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,994 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,995 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,996 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,997 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,998 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:51,999 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,000 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,001 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,002 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,003 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,004 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,005 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,006 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,007 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,008 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,009 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,010 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,011 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,012 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,014 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,015 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,016 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,017 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,018 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,019 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,020 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,021 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,022 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,023 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,024 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,025 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,026 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,027 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,028 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,029 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,030 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,031 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,034 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,036 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,038 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,039 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,041 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,042 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,043 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,044 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,045 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,046 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,048 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,049 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,050 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,051 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,052 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,053 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,055 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,056 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,057 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,058 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,059 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,060 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,061 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,062 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,063 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,064 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,065 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,067 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,068 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,069 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,070 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,071 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,072 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,073 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,074 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,075 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,076 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,077 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,078 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,079 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,080 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,081 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,082 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,083 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,084 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,086 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,087 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,089 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,091 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,093 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,096 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,099 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,103 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,106 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,109 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,112 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,114 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,117 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,120 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,123 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,126 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,128 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,131 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,133 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,135 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,136 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,138 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,139 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,140 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,141 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,143 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,144 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,147 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,150 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,154 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,155 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,157 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,158 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,160 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,161 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,162 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,164 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,165 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,166 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,167 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,168 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,169 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,170 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,171 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,172 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,173 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,174 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,175 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,176 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,177 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,178 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,179 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,180 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,181 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,182 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,183 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,184 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,185 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,186 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,187 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,188 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,190 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,191 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,192 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,193 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,194 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,195 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,196 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,198 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,199 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,201 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,202 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,203 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,204 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,205 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,206 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,207 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,208 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,209 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,210 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,211 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,212 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,213 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,214 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,215 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,216 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,217 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,218 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,219 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,220 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,221 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,222 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,223 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,224 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,225 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,226 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,227 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,228 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,229 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,230 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,231 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,232 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,233 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,234 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,235 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,236 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,237 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,238 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,239 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,240 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,241 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,242 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,243 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,244 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,246 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,247 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,248 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,249 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,250 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,251 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,253 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,254 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,255 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,256 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,258 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,259 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,260 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,261 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,263 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,264 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,265 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,266 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,267 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,268 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,269 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,270 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,271 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,272 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,273 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,274 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,275 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,276 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,277 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,278 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,279 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,280 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,281 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,282 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,283 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,284 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,285 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,286 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,287 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,288 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,289 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,290 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,291 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,292 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,293 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,294 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,296 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,297 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,298 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,299 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,300 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,301 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,302 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,303 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,304 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,305 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,306 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,307 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,308 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,309 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,310 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,311 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,312 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,313 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,314 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,315 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,316 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,317 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,318 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,319 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,320 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,321 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,322 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,323 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,324 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,325 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,326 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,327 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,328 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,329 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,330 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,332 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,333 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,335 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,336 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,338 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,340 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,341 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,342 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,344 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,345 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,346 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,347 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,348 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,349 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,350 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,351 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,352 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,353 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,354 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,355 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,356 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,357 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,358 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,359 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,360 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,362 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,363 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,364 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,365 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,366 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,367 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,368 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,369 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,370 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,371 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,372 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,373 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,374 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,375 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,376 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,377 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,378 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,379 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,380 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,381 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,382 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,383 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,384 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,385 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,386 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,387 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,388 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,389 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,390 - core.event_bus - ERROR - Error processing event: unsupported format string passed to Series.__format__
Traceback (most recent call last):
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 53, in run
    await self._dispatch_event(event)
  File "/home/jovyan/data/trader-v2/core/event_bus.py", line 44, in _dispatch_event
    await handler(event)
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 45, in _on_market_event
    await self.on_market_data(event) # Call user-defined market data handling logic
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/data/trader-v2/components/strategy.py", line 89, in on_market_data
    logger.debug(f"MomentumStrategy: {symbol} at {timestamp} - Momentum ({self.momentum_period} period): {momentum:.2f} (Current: {current_price:.2f}, {self.momentum_period} periods ago: {price_n_periods_ago:.2f})")
                                                                                                         ^^^^^^^^^^^^^^
TypeError: unsupported format string passed to Series.__format__
2025-04-30 07:11:52,390 - __main__ - INFO - Data feed task finished.
2025-04-30 07:11:52,390 - __main__ - INFO - Waiting for all events in the queue to be processed after data feed finished...
2025-04-30 07:11:52,390 - __main__ - INFO - Event queue is finally empty.
2025-04-30 07:11:52,390 - __main__ - INFO - Stopping Event Bus...
2025-04-30 07:11:52,390 - components.metrics - WARNING - No data available to calculate metrics.
